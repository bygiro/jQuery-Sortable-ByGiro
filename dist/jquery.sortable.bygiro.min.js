/*
 * jQuery / jqLite Sortable ByGiro Plugin
 * version: 0.0.1
 * Author: Girolamo Tomaselli http://bygiro.com
 *
 * Copyright (c) 2015 G. Tomaselli
 * Licensed under the MIT license.
 */
var bg=bg||!1;bg||("undefined"!=typeof jQuery?bg=jQuery:"undefined"!=typeof angular&&(bg=angular.element,function(){function a(a,b){if(1==a.length)return a[0].querySelectorAll(b);for(var c=[],d=0;d<a.length;d++){var e=a[d],f=angular.element(e.querySelectorAll(b));c.push.apply(c,f.slice())}return c}function b(a,b){if("undefined"==typeof a)return null;var c="width"==b?"offsetWidth":"offsetHeight";return a[c]}function c(a,b){if("undefined"==typeof a)return null;var f,g,c="paddingTop",d="paddingBottom",e="offsetHeight";return"width"==b&&(c="paddingLeft",d="paddingRight",e="offsetWidth"),f=getComputedStyle(a),g=a[e],f&&(g-=parseFloat(f[c])+parseFloat(f[d])),g}bg.extend=angular.extend,bg.isFunction=angular.isFunction,bg.prototype.is=function(a){for(var b=0;b<this.length;b++){var c=this[b];if((c.matches||c.matchesSelector||c.msMatchesSelector||c.mozMatchesSelector||c.webkitMatchesSelector||c.oMatchesSelector).call(c,a))return!0}return!1},bg.prototype.closest=function(a){for(var b=0;b<this.length;b++)for(var c=this[b];c;){if(bg(c).is(a))return c;c=c.parentNode}return!1},bg.prototype.find=function(b){var c=this[0];if(!c||1!==c.nodeType&&9!==c.nodeType||!angular.isString(b))return[];var d=[];if(">"===b.charAt(0)&&(b=":scope "+b),b.indexOf(":visible")>-1){var e=angular.element(a(this,b.split(":visible")[0]));forEach(e,function(a,b){angular.element(a).is(":visible")&&d.push(a)})}else d=a(this,b);return d.length?1==d.length?angular.element(d[0]):angular.element(d):angular.element()},bg.prototype.outerWidth=function(){return b(this[0],"width")},bg.prototype.width=function(){return c(this[0],"width")},bg.prototype.outerHeight=function(){b(this[0])},bg.prototype.height=function(){c(this[0])},bg.prototype.offset=function(){var a=this[0].getBoundingClientRect();return{top:a.top+document.body.scrollTop,left:a.left+document.body.scrollLeft}}}())),function(a,b,c){"use strict";var d="sortableByGiro",e="plugin_"+d,f={eNames:{init:"initialized.sortableByGiro",dropped:"dropped.sortableByGiro",canceled:"canceled.sortableByGiro",start:"touchstart.sortableByGiro mousedown.sortableByGiro",drop:"touchend.sortableByGiro touchleave.sortableByGiro touchcancel.sortableByGiro mouseup.sortableByGiro mouseout.sortableByGiro",drag:"touchmove.sortableByGiro mousemove.sortableByGiro"},onDragstart:function(){return!0},isValidTarget:function(a){return!0},isValidSource:function(a){return!0},onDrop:function(a){},onCancel:function(){},vertical:!0,thresholdTarget:50,enabled:!0,clone:!1,drag:!0,drop:!0,itemSelector:"",handle:"",dropHandle:"",draggingClass:"bg-dragging",targetsClass:"bg-sortable-target",closestTargetClass:"bg-closest-target",closestItemClass:"bg-closest-item",attrPlaceholder:"data-sortable-bygiro-placeholder",attrDragging:"data-sortable-bygiro-dragging-item",placeholder:'<li class="placeholder"></li>'},g=function(a){return a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault(),a.cancelBubble=!0,a.returnValue=!1,!1},h=function(a){for(var c,b=a.parentNode,d=0;d<b.children.length;d++)if(c=b.children[d],c===a)return d},i=function(a,b){for(var c=b.parentNode;null!=c;){if(c===a)return!0;c=c.parentNode}return!1},k=function(b,c,d,e,f){if(!b||b.length<=1)return b;for(var i,j,k,m,g={},h=[],n=0;n<b.length;n++)j=b[n],k=a(j),m=k.offset(),i=Math.floor(Math.sqrt(Math.pow(c-(m.left+k.height()/2),2)+Math.pow(d-(m.top+k.height()/2),2))),e&&i>e||(i+=n,h.push(i),g[i]=n);h.sort();var o=[];for(var n in h)o[n]=b[g[h[n]]];return o},l=function(){var b=this.options,c=b.placeholder;return c instanceof a||(c=a(c)),c.attr(b.attrPlaceholder,"").wrap("<div></div>").parent().html()},m=function(b){var d,c=!1;if("string"==typeof b?c=a(b):b instanceof a?c=b:b instanceof Array?c=b:b&&(c=[b]),c){d=[];for(var e=0;e<c.length;e++)d.push(c[e]);c=d}return c||[]},n=function(b,c){var g,i,j,d=this,e=d.options;if(!e.drop)return!1;i=m(b),j=e.drop!==!0?m(e.drop):[];for(var k=0;k<i.length;k++)if(g=i[k],!(j.length&&j.indexOf(g)<0)&&("function"!=typeof e.isValidSource||e.isValidSource.call(d,a(g))))return!0;return!1},o=function(d){function G(a){return a&&a.length}var h,n,r,s,t,u,v,w,f=this,g=f.options,i=!1,j=[],o=l.call(f),y=f.$element,z=a("body");if(z.find("."+g.closestTargetClass).removeClass(g.closestTargetClass),z.find("."+g.targetsClass).removeClass(g.targetsClass),z.find("."+g.closestItemClass).removeClass(g.closestItemClass),n=m(f.$element),g.drag&&g.drag!==!0&&(n=n.concat(m(g.drag))),z.find("["+g.attrPlaceholder+"]").remove(),f.dragging){var A=f.dragging.item.find(n);if(A.length)for(var B=0;B<A.length;B++)for(var C=0;C<n.length;C++)if(A[B]===n[C]){n.splice(C,1);break}y=f.dragging.oldContainer}for(var B=0;B<n.length;B++){h=!0,w=n[B],"function"==typeof g.isValidTarget&&(h=g.isValidTarget.call(f,a(w)));var D=a(w).data(e);h&&D&&(h=D.canDrop(y)),h&&j.push(w)}var E=d.pageX,F=d.pageY;if(v=b.elementFromPoint(E-c.pageXOffset,F-c.pageYOffset)||d.target,j.indexOf(v)>=0&&(i=a(v)),!G(i)&&(!g.dropHandle||g.dropHandle.length&&a(v).is(g.dropHandle))&&(i=q.call(f,v,j,1),i=k(i,E,F,g.thresholdTarget)),G(i)||(i=q.call(f,v,j)),G(i)||(i=k(j,E,F,g.thresholdTarget)),a(j).addClass(g.targetsClass),G(i)&&(a(i[0]).addClass(g.closestTargetClass),!(v!==i[0]&&a(v).closest(i[0]).length<=0))){u=q.call(f,i[0]),u=u.length?u.data(e):f,s=u.getItems(i[0])||[];var H=f.prevClosestItem&&a(f.prevClosestItem).closest(j)[0]===a(f.prevClosestItem).closest(i[0])[0];if(r=!1,1==s.length)r=s[0];else{for(var I=!1,B=0;B<s.length;B++){if(v===s[B]||a(v).closest(s[B]).length){r=s[B];break}H&&s[B]===f.prevClosestItem&&(I=f.prevClosestItem)}!r&&I&&(r=I),r||(s=k(s,E,F),r=s[0])}if(!r)return void a(i[0]).append(o);a(r).addClass(g.closestItemClass),t=p(a(r),d,g.vertical),r.insertAdjacentHTML(t?"afterend":"beforebegin",o),f.prevClosestItem=r}},p=function(a,b,c){var g,d=a.offset(),e=d.top,f=d.left;return c?(e+=a.height()/2,g=b.pageY-e>=0):(f+=a.width()/2,g=b.pageX-f>=0),g},q=function(b,c,d){var h,j,k,f=this,g=!1;if(d=d||!1,!c||c.length){if(b)b instanceof a||(b=a(b));else{if(!f.dragging)return;b=f.dragging.item}for(h=b;!g&&h.length&&!h.is("html");){for(var l=0;l<h.length;l++)if(k=a(h[l]),j="undefined"!=typeof k.data(e),c&&(j=c.indexOf(k[0])>=0?!0:!1),j){g=!0;break}g||(h=d?h.children():h.parent())}return g?k:!1}},r=function(b){var d,e,c=this,f=c.options.itemSelector;if(b){d=[];for(var g=0;g<c.$element.length;g++)d.push(c.$element[g]);e=m(b);for(var g=0;g<e.length;g++)d.indexOf(e[g])<0&&d.push(e[g]);for(var j,k,l,h=[],g=0;g<d.length;g++)k=a(d[g]),j=f&&f.length?k.find(f):k.children(),h[g]=m(j);for(var g=0;g<d.length;g++){k=d[g],j=h[g];for(var n=0;n<d.length;n++)l=d[n],i(k,l)&&j.filter(function(a){return h[n].indexOf(a)<0});h[g]=j}for(var o,p=[],n=0;n<e.length;n++)o=d.indexOf(e[n]),p=p.concat(h[o]);f=a(p)}else f=f&&f.length?c.$element.find(f):c.$element.children();return f},s=function(b,c){var d=this,e=d.options;!b||c?r.call(d):0;if(b)return a("body").off(e.eNames.drag),a("body").off(e.eNames.drop),void(c&&d.$element.off(e.eNames.start));var j=e.itemSelector&&e.itemSelector.length?e.itemSelector:d.$element.children();d.$element.on(e.eNames.start,function(b){for(var c=a(b.target),f=!1;c.length&&!c.is(d.$element);){if(c.is(j)){f=c;break}c=c.parent()}if(f){var g=!0;e.handle.length&&(g=!1,(a(b.target).is(e.handle)||a(b.target).closest(e.handle).length)&&(g=!0)),g&&v.call(d,b,f)}})},t=function(){var b=this.options,c=a("body");c.find("["+b.attrPlaceholder+"],["+b.attrDragging+"]").remove(),c.find("."+b.closestTargetClass).removeClass(b.closestTargetClass),c.find("."+b.targetsClass).removeClass(b.targetsClass),c.find("."+b.closestItemClass).removeClass(b.closestItemClass)},u=function(){var g,b=this,c=this.options,d=!1,f=a("body").find("["+c.attrPlaceholder+"]");if(!b.dragging)return c.onCancel.call(b),b.$element.triggerHandler(c.eNames.canceled,b),delete b.dragging,t.call(b),void s.call(b,1);if(b.dragging.target=f,f.length){var i=q.call(b,f),j=!1;b.dragging.newContainer=f.closest("."+c.targetsClass),b.dragging.newIndex=h(f[0]),d=!0,i&&(j=i.data(e),j&&(b.dragging.oldContainer||j.canDrop(b.dragging.oldContainer)||(d=!1),d&&"function"==typeof j.options.onDrop&&j.options.onDrop.call(j,b)))}if(g=b.dragging&&b.dragging.item?b.dragging.item:!1)if(g.removeClass(c.draggingClass).removeAttr(c.attrDragging).css({position:"",left:"",top:""}),d)b.dragging.target.replaceWith(b.dragging.item),j?(j.$element.triggerHandler(c.eNames.dropped,b),j.reInitHandler()):(b.$element.triggerHandler(c.eNames.dropped,b),b.reInitHandler());else if(c.onCancel.call(b),b.$element.triggerHandler(c.eNames.canceled,b),c.clone)b.dragging.item&&b.dragging.item.remove();else{var k=b.dragging.oldContainer,l=b.dragging.oldIndex,m=!1,g=b.dragging.item;if(k){if(l>0){var n=r.call(b,k);n.length&&(m=n[l-1]?a(n[l-1]):!1)}m?m.after(g):k.prepend(g)}}delete b.dragging,t.call(b),s.call(b,1)},v=function(c,d){var j,e=this,f=e.options,i=!0;if(g(c),f.enabled){if(j=m(e.$element),f.drag&&f.drag!==!0&&(j=j.concat(m(f.drag))),e.dragging={oldIndex:h(d[0]),originalItem:d,item:f.clone?d.clone(!0):d,oldContainer:q.call(e,d,j)},"function"==typeof f.onDragstart&&(i=f.onDragstart.call(e,d)),!i)return delete e.dragging,t.call(e),void s.call(e,1);o.call(e,c),e.dragging.item.addClass(f.draggingClass).attr(f.attrDragging,"").css({position:"absolute",left:c.pageX+10,top:c.pageY+5}),a("body").append(e.dragging.item).on(f.eNames.drag,function(a){return g(a),e.dragging?(e.dragging.item.css({left:a.pageX+10,top:a.pageY+5}),void o.call(e,a)):(t.call(e),void s.call(e,1))}).on(f.eNames.drop,function(c){if("mouseout"==c.type){if(c.relatedTarget!==b.querySelector("html"))return;a("body").find("["+f.attrPlaceholder+"]").remove()}g(c),u.call(e)})}},w={init:function(b,c){var e,g,d=this;d.$element=a(b),e=d.$element.data(),g=d.options=a.extend({},f,e,c),d.$element.triggerHandler(g.eNames.init,d),s.call(d)},getItems:function(a){return r.call(this,a)},reInitHandler:function(){s.call(this,1,1),s.call(this)},canDrop:function(a){return n.call(this,a)}},x=function(b){var c=this.data(e);return c?"string"==typeof b?c[b]?c[b].apply(c,Array.prototype.slice.call(arguments,1)):console.log("Method "+b+" does not exist on jQuery / jqLite "+d):void 0:b&&"object"!=typeof b?console.log(d+' is not instantiated. Please call $("selector").'+d+"({options})"):(c=a.extend({},w),c.init(this,b),this.data(e,c),this)};a.fn?a.fn[d]=x:a.prototype[d]=x,a(b).ready(function(){var c=b.querySelector("[data-sortable-init]");a(c).length&&a(c)[d]({})})}(bg,document,window);